<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>UIA Lens — Editor</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}" />
  <link rel="stylesheet" href="{{ url_for('static', filename='css/editor.css') }}" />
</head>

<body class="page-editor">
  <header class="menubar">
    <div class="brand">UIA Lens</div>
    <nav class="menus">
      <details>
        <summary>File</summary>
        <ul>
          <li><a href="#" id="file-new">New</a></li>
          <li><a href="#" id="file-open-local">Open (from computer)</a></li>
          <li><a href="#" id="file-open-storage">Open (from storage)</a></li>
          <li class="sep"></li>
          <li><a href="#" id="file-save-as">Save As…</a></li>
          <li class="sep"></li>
          <li><a href="/api/v1/files/export?type=zip">Export Project (.zip)</a></li>
        </ul>
      </details>

      <details>
        <summary>Select</summary>
        <ul>
          <li><a href="#">Rectangular</a></li>
          <li><a href="#">Freeform</a></li>
          <li><a href="#">Polygonal</a></li>
          <li><a href="#">Magic Lasso</a></li>
        </ul>
      </details>

      <details>
        <summary>Filter</summary>
        <ul>
          <li><a href="#">Gaussian</a></li>
          <li><a href="#">Sobel</a></li>
          <li><a href="#">Binary</a></li>
          <li><a href="#">Histogram</a></li>
        </ul>
      </details>

      <details>
        <summary>Tools</summary>
        <ul>
          <li><a href="#">Brush</a></li>
          <li><a href="#">Eraser</a></li>
          <li><a href="#">Bucket</a></li>
          <li><a href="#">Dropper</a></li>
          <li class="sep"></li>
          <li><a href="#">Color</a></li>
          <li><a href="#">Size</a></li>
          <li><a href="#">Pattern</a></li>
          <li><a href="#">Load Pattern Image</a></li>
        </ul>
      </details>

      <details>
        <summary>Shapes</summary>
        <ul>
          <li><a href="#">Textbox</a></li>
          <li><a href="#">Rectangle</a></li>
          <li><a href="#">Ellipse</a></li>
          <li><a href="#">Line</a></li>
          <li><a href="#">Polygon</a></li>
        </ul>
      </details>

      <details>
        <summary>Camera</summary>
        <ul>
          <li><a href="#">Live Feed</a></li>
          <li><a href="#">Capture to New Layer</a></li>
        </ul>
      </details>
    </nav>

  </header>


  <aside class="toolbar" aria-label="Tools">
    <button data-tool="rectangular" title="Select (Rectangular)">▭</button>
    <button data-tool="freeform_select" title="Freeform Select">✏️</button>
    <button data-tool="polygoanl_select" title="Polygonal Select">🔺</button>
    <button data-tool="magic_lasso" title="Magic Lasso">🪄</button>
    <hr />
    <button data-tool="brush" title="Brush">🖌️</button>
    <input type="color" id="color-picker" value="#ff0000" hidden />
    <button data-tool="eraser" title="Eraser">🩹</button>
    <button data-tool="bucket" title="Bucket">🪣</button>
    <button data-tool="dropper" title="Dropper">🎯</button>
    <hr />
    <button data-tool="textbox" title="Textbox">🔤</button>
    <button data-tool="shapes" title="Shapes">⬛</button>
  </aside>


  <main class="canvas-area" aria-label="Canvas area">
    <div class="canvas-stack">
      <div class="image-stack" style="width: {{ data.width }}px; height: {{ data.height }}px;">
        {% for layer in data.layers %}
        <img src="{{ url_for('ui.layer_img', filename=layer.filename) }}" alt="{{ layer.name }}" class="stacked-img"
          id="layer{{loop.index0}}" {% if layer.visible==1 %} style="visibility: visible;" {% else %}
          style="visibility: hidden;" {% endif %}>
        {% endfor %}
        <canvas id="paint-overlay" width="{{ data.width }}" height="{{ data.height }}"></canvas>
      </div>

      <div class="zoom-overlay">
        <div class="zoom">
          <button title="Zoom out" data-zoom="out">−</button>
          <input type="range" min="10" max="400" value="100" />
          <button title="Zoom in" data-zoom="in">＋</button>
          <span class="zoom-value">zoom</span>
        </div>
      </div>
    </div>

    <!--
  <menu class="context-menu" hidden>
    <button>Copy</button>
    <button>Paste</button>
    <button>Cut</button>
    <button>Rotate</button>
    <button>Resize</button>
    <button>Identify</button>
  </menu>
  */-->
  </main>

  <aside class="layers-panel" aria-label="Layers">
    <header class="layers-header">
      <h2>Layers</h2>
    </header>
    <div class="layer-actions">
      <button title="Add layer" onclick="addLayer()">＋</button>
      <button title="Delete layer" onclick="deleteLayer()">🗑️</button>
      <button title="Rename layer" onclick="renameLayer()">✎</button>
      <button title="Copy layer" onclick="duplicateLayer()">⧉</button>
    </div>

    <div class="layers-list" id="layer_list">
      {% for layer in data.layers %}
      <div class="layer-item {% if data.selected_layer==loop.index0 %}active{% endif %}">
        <button class="layer-name" onclick="setActive(this.parentElement, {{ loop.index0 }})">
          {{ layer.name }}
        </button>
        <button class="layer-hide" onclick="toggleVisibility(this, {{ loop.index0 }})">
          {% if layer.visible == 1 %}
          👁️
          {% else %}
          🚫
          {% endif %}
        </button>
      </div>
      {% endfor %}

    </div>

    <div class="quick-actions">
      <button title="Undo">↶</button>
      <button title="Redo">↷</button>
    </div>
    <hr />
    <div class="tool-settings">
      <p>Brush and Eraser size:</p>

      <label for="size-slider">Size:</label>
      <input type="range" id="size-slider" min="1" max="100" value="10">
      <span id="size-value">10</span>
    </div>

    <section class="storage-projects" aria-label="Projects in storage">
      <header class="projects-header">
        <h3>Projects</h3>
        <button id="projects-refresh" title="Refresh list">↻</button>
      </header>
      <div id="projects-list" class="projects-list" aria-live="polite">
      </div>
    </section>

  </aside>

</body>
<input type="file" id="file-open-input" hidden />
<script src="{{ url_for('static', filename='js/app.js') }}" defer></script>
<script src="{{ url_for('static', filename='js/layers.js') }}" defer></script>
<script src="{{ url_for('static', filename='js/paint.js') }}" defer></script>
<script src="{{ url_for('static', filename='js/fileops.js') }}" defer></script>

</html>
